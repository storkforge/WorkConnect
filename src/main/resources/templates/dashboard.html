<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>WorkConnect Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen">

<!-- HEADER -->
<header class="bg-white shadow px-6 py-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-blue-600">WorkConnect</h1>
    <a th:href="@{/logout}" class="text-sm text-gray-600 hover:text-blue-600">Logout</a>
</header>

<!-- MAIN CONTAINER -->
<div class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6 py-10 px-4">

    <!-- SIDEBAR -->
    <aside class="lg:col-span-4 space-y-6">
        <!-- Profile Card -->
        <div class="bg-white p-6 rounded-2xl shadow hover:shadow-lg transition text-center">
            <div class="w-24 h-24 bg-gray-200 rounded-full mx-auto mb-4 flex items-center justify-center text-gray-500 text-3xl">üë§</div>
            <p class="text-lg font-semibold" th:text="${user?.name}">Your Name</p>
            <p class="text-sm text-gray-500" th:text="${user?.email}">you@example.com</p>
        </div>

        <!-- Articles -->
        <div class="bg-white p-6 rounded-2xl shadow hover:shadow-lg transition">
            <h2 class="text-md font-semibold mb-4 text-gray-700">üìö Useful Articles</h2>
            <ul class="text-sm space-y-3">
                <li>
                    <a href="https://www.indeed.com/career-advice/resumes-cover-letters/how-to-write-a-cv"
                       target="_blank" class="text-blue-600 hover:underline flex items-center gap-2">
                        ‚úçÔ∏è How to write a great CV
                    </a>
                </li>
                <li>
                    <a href="https://www.coursera.org/articles/common-it-interview-questions-and-how-to-answer-them"
                       target="_blank" class="text-blue-600 hover:underline flex items-center gap-2">
                        üéØ Preparing for Interviews
                    </a>
                </li>
            </ul>
        </div>

        <!-- AI Career Coach -->
        <div class="bg-white p-6 rounded-2xl shadow hover:shadow-lg transition">
            <h2 class="text-md font-semibold mb-3 text-gray-700">üß† AI Career Coach</h2>
            <form id="coachForm" class="space-y-3">
                <textarea id="coachInput" name="question" placeholder="Ask the AI Coach anything..."
                          class="w-full p-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"></textarea>
                <button type="submit"
                        class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    Ask Coach
                </button>
            </form>
            <div id="coachResponse" class="mt-4 bg-gray-50 border border-gray-200 p-3 rounded text-sm text-gray-800 hidden"></div>
            <button id="resetCoach"
                    class="mt-2 w-full bg-gray-200 text-gray-700 py-1 px-4 rounded-md hover:bg-gray-300 hidden">
                üîÑ New Question
            </button>
        </div>

        <script>
            const coachForm = document.getElementById('coachForm');
            const coachInput = document.getElementById('coachInput');
            const responseBox = document.getElementById('coachResponse');
            const resetButton = document.getElementById('resetCoach');

            coachForm.addEventListener('submit', async function (e) {
                e.preventDefault();
                const question = coachInput.value.trim();

                if (!question) {
                    responseBox.innerText = "‚ö†Ô∏è Please enter a question.";
                    responseBox.classList.remove('hidden');
                    resetButton.classList.remove('hidden');
                    return;
                }

                responseBox.innerText = "‚è≥ Thinking...";
                responseBox.classList.remove('hidden');
                resetButton.classList.add('hidden');

                try {
                    const response = await fetch('/api/ai/career-coach', {
                        method: 'POST',
                        headers: { 'Content-Type': 'text/plain' },
                        body: question
                    });

                    const text = await response.text();
                    responseBox.innerText = text;
                } catch (error) {
                    responseBox.innerText = "‚ùå Something went wrong. Please try again later.";
                }

                resetButton.classList.remove('hidden');
            });

            resetButton.addEventListener('click', function () {
                coachInput.value = "";
                responseBox.classList.add('hidden');
                resetButton.classList.add('hidden');
            });
        </script>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="lg:col-span-8 bg-white p-8 rounded-2xl shadow hover:shadow-lg transition">
        <h2 class="text-2xl font-bold mb-8 text-center text-gray-800">üíº Job Opportunities</h2>

        <div class="flex flex-col items-center space-y-5">
            <a href="/jobs" class="px-5 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 font-medium rounded-md transition">üìÇ View Job List</a>

            <span th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
                <a href="/jobs/new" class="px-5 py-2 bg-green-100 hover:bg-green-200 text-green-700 font-medium rounded-md transition">
                    ‚ûï Post New Job
                </a>
            </span>
        </div>
    </main>

</div>

</body>
</html>
